<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tabular Binary Classification (Beginner)</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Welcome to fastai">
    
    <link rel="preload" href="/walkwithfastai.github.io/assets/css/0.styles.57b101cf.css" as="style"><link rel="preload" href="/walkwithfastai.github.io/assets/js/app.d213da4d.js" as="script"><link rel="preload" href="/walkwithfastai.github.io/assets/js/2.3552a41d.js" as="script"><link rel="preload" href="/walkwithfastai.github.io/assets/js/10.1c53449a.js" as="script"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/11.f91edc13.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/12.c9267090.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/13.905833e1.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/14.71aae364.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/15.96fcd54f.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/16.60f565fe.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/17.6360a1cb.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/3.fb63bfb9.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/4.b52d6096.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/5.1a7d8c98.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/6.86aec1e1.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/7.9883384d.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/8.4b03437f.js"><link rel="prefetch" href="/walkwithfastai.github.io/assets/js/9.0fe2b969.js">
    <link rel="stylesheet" href="/walkwithfastai.github.io/assets/css/0.styles.57b101cf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/walkwithfastai.github.io/" class="home-link router-link-active"><img src="https://www.jovian.ml/fastai_logo.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/walkwithfastai.github.io/" class="nav-link">
  Overview
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Introduction" class="dropdown-title"><span class="title">Introduction</span> <span class="arrow down"></span></button> <button type="button" aria-label="Introduction" class="mobile-dropdown-title"><span class="title">Introduction</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/walkwithfastai.github.io/intro.contribute.html" class="nav-link">
  How to Contribute a Chapter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vision" class="dropdown-title"><span class="title">Vision</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vision" class="mobile-dropdown-title"><span class="title">Vision</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/walkwithfastai.github.io/vision.intro.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><h4>
          Classification
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/walkwithfastai.github.io/vision.clas.single_label.html" class="nav-link">
  Single Label (Beginner)
</a></li></ul></li><li class="dropdown-item"><h4>
          External Model Integrations
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/walkwithfastai.github.io/vision.external.timm.html" class="nav-link">
  timm
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tabular" class="dropdown-title"><span class="title">Tabular</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tabular" class="mobile-dropdown-title"><span class="title">Tabular</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/walkwithfastai.github.io/tab.clas.binary.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Introduction
</a></li><li class="dropdown-item"><h4>
          Classification
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/walkwithfastai.github.io/tab.clas.binary.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Binary (Beginner)
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/walkwithfastai.github.io/tab.cv.html" class="nav-link">
  Cross Validation (Intermediate)
</a></li></ul></div></div> <a href="https://github.com/walkwithfastai/walkwithfastai.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/walkwithfastai.github.io/" class="nav-link">
  Overview
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Introduction" class="dropdown-title"><span class="title">Introduction</span> <span class="arrow down"></span></button> <button type="button" aria-label="Introduction" class="mobile-dropdown-title"><span class="title">Introduction</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/walkwithfastai.github.io/intro.contribute.html" class="nav-link">
  How to Contribute a Chapter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vision" class="dropdown-title"><span class="title">Vision</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vision" class="mobile-dropdown-title"><span class="title">Vision</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/walkwithfastai.github.io/vision.intro.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><h4>
          Classification
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/walkwithfastai.github.io/vision.clas.single_label.html" class="nav-link">
  Single Label (Beginner)
</a></li></ul></li><li class="dropdown-item"><h4>
          External Model Integrations
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/walkwithfastai.github.io/vision.external.timm.html" class="nav-link">
  timm
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tabular" class="dropdown-title"><span class="title">Tabular</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tabular" class="mobile-dropdown-title"><span class="title">Tabular</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/walkwithfastai.github.io/tab.clas.binary.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Introduction
</a></li><li class="dropdown-item"><h4>
          Classification
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/walkwithfastai.github.io/tab.clas.binary.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Binary (Beginner)
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/walkwithfastai.github.io/tab.cv.html" class="nav-link">
  Cross Validation (Intermediate)
</a></li></ul></div></div> <a href="https://github.com/walkwithfastai/walkwithfastai.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tabular Binary Classification (Beginner)</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/walkwithfastai.github.io/tab.clas.binary.html#binary-classification" class="sidebar-link">Binary Classification</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/walkwithfastai.github.io/tab.clas.binary.html#tabularpandas" class="sidebar-link">TabularPandas</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/walkwithfastai.github.io/tab.clas.binary.html#categorify" class="sidebar-link">Categorify</a></li><li class="sidebar-sub-header"><a href="/walkwithfastai.github.io/tab.clas.binary.html#normalize" class="sidebar-link">Normalize</a></li><li class="sidebar-sub-header"><a href="/walkwithfastai.github.io/tab.clas.binary.html#fillmissing" class="sidebar-link">FillMissing</a></li></ul></li><li><a href="/walkwithfastai.github.io/tab.clas.binary.html#the-dataloaders" class="sidebar-link">The DataLoaders</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/walkwithfastai.github.io/tab.clas.binary.html#tabular-learner-and-training-a-model" class="sidebar-link">Tabular Learner and Training a Model</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/walkwithfastai.github.io/tab.clas.binary.html#categorical-variables" class="sidebar-link">Categorical Variables</a></li><li class="sidebar-sub-header"><a href="/walkwithfastai.github.io/tab.clas.binary.html#numerical-variables" class="sidebar-link">Numerical Variables</a></li><li class="sidebar-sub-header"><a href="/walkwithfastai.github.io/tab.clas.binary.html#tabularmodel" class="sidebar-link">TabularModel</a></li><li class="sidebar-sub-header"><a href="/walkwithfastai.github.io/tab.clas.binary.html#tabular-learner" class="sidebar-link">tabular_learner</a></li></ul></li><li><a href="/walkwithfastai.github.io/tab.clas.binary.html#inference" class="sidebar-link">Inference</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tabular-binary-classification-beginner"><a href="#tabular-binary-classification-beginner" class="header-anchor">#</a> Tabular Binary Classification (Beginner)</h1> <blockquote><p>Introducing the Tabular API with an example problem</p></blockquote> <hr> <p>This article is also a Jupyter Notebook available to be run from the top down. There will be code snippets that you can then run in any environment. Below are the versions of <code>fastai</code> and <code>fastcore</code> currently running at the time of writing this:</p> <ul><li><code>fastai</code>: 2.0.14</li> <li><code>fastcore</code>: 1.0.11</li></ul> <hr> <h2 id="binary-classification"><a href="#binary-classification" class="header-anchor">#</a> Binary Classification</h2> <p>In this example we will be walking through the <code>fastai</code> tabular API to perform binary classification on the Salary dataset.</p> <p>This notebook can run along side the first tabular lesson from Walk with fastai2, shown <a href="https://www.youtube.com/watch?v=liTHAhdl1cQ&amp;list=PLFDkaGxp5BXDvj3oHoKDgEcH73Aze-eET&amp;index=9&amp;t=430s" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>First we need to call the tabular module:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> fastai<span class="token punctuation">.</span>tabular<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span>
</code></pre></div><p>And grab our dataset:</p> <div class="language-python extra-class"><pre class="language-python"><code>path <span class="token operator">=</span> untar_data<span class="token punctuation">(</span>URLs<span class="token punctuation">.</span>ADULT_SAMPLE<span class="token punctuation">)</span>
</code></pre></div><p>If we look at the contents of our folder, we will find our data lives in <code>adult.csv</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code>path<span class="token punctuation">.</span>ls<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>(#3) [Path('/home/ml1/.fastai/data/adult_sample/models'),Path('/home/ml1/.fastai/data/adult_sample/export.pkl'),Path('/home/ml1/.fastai/data/adult_sample/adult.csv')]
</code></pre></div><p>We'll go ahead and open it in <code>Pandas</code> and take a look:</p> <div class="language-python extra-class"><pre class="language-python"><code>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>path<span class="token operator">/</span><span class="token string">'adult.csv'</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>age</th> <th>workclass</th> <th>fnlwgt</th> <th>education</th> <th>education-num</th> <th>marital-status</th> <th>occupation</th> <th>relationship</th> <th>race</th> <th>sex</th> <th>capital-gain</th> <th>capital-loss</th> <th>hours-per-week</th> <th>native-country</th> <th>salary</th></tr></thead> <tbody><tr><th>0</th> <td>49</td> <td>Private</td> <td>101320</td> <td>Assoc-acdm</td> <td>12.0</td> <td>Married-civ-spouse</td> <td>NaN</td> <td>Wife</td> <td>White</td> <td>Female</td> <td>0</td> <td>1902</td> <td>40</td> <td>United-States</td> <td>&gt;=50k</td></tr> <tr><th>1</th> <td>44</td> <td>Private</td> <td>236746</td> <td>Masters</td> <td>14.0</td> <td>Divorced</td> <td>Exec-managerial</td> <td>Not-in-family</td> <td>White</td> <td>Male</td> <td>10520</td> <td>0</td> <td>45</td> <td>United-States</td> <td>&gt;=50k</td></tr> <tr><th>2</th> <td>38</td> <td>Private</td> <td>96185</td> <td>HS-grad</td> <td>NaN</td> <td>Divorced</td> <td>NaN</td> <td>Unmarried</td> <td>Black</td> <td>Female</td> <td>0</td> <td>0</td> <td>32</td> <td>United-States</td> <td>&lt;50k</td></tr> <tr><th>3</th> <td>38</td> <td>Self-emp-inc</td> <td>112847</td> <td>Prof-school</td> <td>15.0</td> <td>Married-civ-spouse</td> <td>Prof-specialty</td> <td>Husband</td> <td>Asian-Pac-Islander</td> <td>Male</td> <td>0</td> <td>0</td> <td>40</td> <td>United-States</td> <td>&gt;=50k</td></tr> <tr><th>4</th> <td>42</td> <td>Self-emp-not-inc</td> <td>82297</td> <td>7th-8th</td> <td>NaN</td> <td>Married-civ-spouse</td> <td>Other-service</td> <td>Wife</td> <td>Black</td> <td>Female</td> <td>0</td> <td>0</td> <td>50</td> <td>United-States</td> <td>&lt;50k</td></tr></tbody></table></div> <h2 id="tabularpandas"><a href="#tabularpandas" class="header-anchor">#</a> TabularPandas</h2> <p><code>fastai</code> has a new way of dealing with tabular data by utilizing a <a href="https://docs.fast.ai/tabular.core#TabularPandas" target="_blank" rel="noopener noreferrer"><code>TabularPandas</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> object. It expects some dataframe, some <code>procs</code>, <code>cat_names</code>, <code>cont_names</code>, <code>y_names</code>, <code>y_block</code>, and some <code>splits</code>. We'll walk through all of them</p> <p>First we need to grab our categorical and continuous variables, along with how we want to process our data.</p> <div class="language-python extra-class"><pre class="language-python"><code>cat_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'workclass'</span><span class="token punctuation">,</span> <span class="token string">'education'</span><span class="token punctuation">,</span> <span class="token string">'marital-status'</span><span class="token punctuation">,</span> <span class="token string">'occupation'</span><span class="token punctuation">,</span> <span class="token string">'relationship'</span><span class="token punctuation">,</span> <span class="token string">'race'</span><span class="token punctuation">]</span>
cont_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'fnlwgt'</span><span class="token punctuation">,</span> <span class="token string">'education-num'</span><span class="token punctuation">]</span>
</code></pre></div><p>When we pre-process tabular data with <code>fastai</code>, we do one or more of three transforms:</p> <ul><li><a href="/walkwithfastai.github.io/tab.stats.html#Categorify"><code>Categorify</code></a></li> <li><a href="/walkwithfastai.github.io/tab.stats.html#FillMissing"><code>FillMissing</code></a></li> <li><a href="https://docs.fast.ai/data.transforms#Normalize" target="_blank" rel="noopener noreferrer"><code>Normalize</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="categorify"><a href="#categorify" class="header-anchor">#</a> Categorify</h3> <p><a href="/walkwithfastai.github.io/tab.stats.html#Categorify"><code>Categorify</code></a> will transform columns that are in your <code>cat_names</code> into that type, along with label encoding our categorical data.</p> <p>First we'll make an instance of it:</p> <div class="language-python extra-class"><pre class="language-python"><code>cat <span class="token operator">=</span> Categorify<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>And now let's try transforming a dataframe</p> <div class="language-python extra-class"><pre class="language-python"><code>to <span class="token operator">=</span> TabularPandas<span class="token punctuation">(</span>df<span class="token punctuation">,</span> cat<span class="token punctuation">,</span> cat_names<span class="token punctuation">)</span>
</code></pre></div><p>We can then extract that transform from <code>to.procs.categorify</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code>cats <span class="token operator">=</span> to<span class="token punctuation">.</span>procs<span class="token punctuation">.</span>categorify
</code></pre></div><p>Let's take a look at the categories:</p> <div class="language-python extra-class"><pre class="language-python"><code>cats<span class="token punctuation">[</span><span class="token string">'relationship'</span><span class="token punctuation">]</span>
</code></pre></div><div class="language- extra-class"><pre><code>(#7) ['#na#',' Husband',' Not-in-family',' Other-relative',' Own-child',' Unmarried',' Wife']
</code></pre></div><p>We can see that it added a <code>#na#</code>category. Let's look at the actual column:</p> <div class="language-python extra-class"><pre class="language-python"><code>to<span class="token punctuation">.</span>show<span class="token punctuation">(</span>max_n<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>workclass</th> <th>education</th> <th>marital-status</th> <th>occupation</th> <th>relationship</th> <th>race</th></tr></thead> <tbody><tr><th>0</th> <td>Private</td> <td>Assoc-acdm</td> <td>Married-civ-spouse</td> <td>#na#</td> <td>Wife</td> <td>White</td></tr> <tr><th>1</th> <td>Private</td> <td>Masters</td> <td>Divorced</td> <td>Exec-managerial</td> <td>Not-in-family</td> <td>White</td></tr> <tr><th>2</th> <td>Private</td> <td>HS-grad</td> <td>Divorced</td> <td>#na#</td> <td>Unmarried</td> <td>Black</td></tr></tbody></table> <p>We can see now, for example, that <code>occupation</code> got returned a <code>#na#</code>value (as it was missing)</p> <p>If we call <code>to.cats</code> we can see our one-hot encoded variables:</p> <div class="language-python extra-class"><pre class="language-python"><code>to<span class="token punctuation">.</span>cats<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>workclass</th> <th>education</th> <th>marital-status</th> <th>occupation</th> <th>relationship</th> <th>race</th></tr></thead> <tbody><tr><th>0</th> <td>5</td> <td>8</td> <td>3</td> <td>0</td> <td>6</td> <td>5</td></tr> <tr><th>1</th> <td>5</td> <td>13</td> <td>1</td> <td>5</td> <td>2</td> <td>5</td></tr> <tr><th>2</th> <td>5</td> <td>12</td> <td>1</td> <td>0</td> <td>5</td> <td>3</td></tr> <tr><th>3</th> <td>6</td> <td>15</td> <td>3</td> <td>11</td> <td>1</td> <td>2</td></tr> <tr><th>4</th> <td>7</td> <td>6</td> <td>3</td> <td>9</td> <td>6</td> <td>3</td></tr></tbody></table></div> <h3 id="normalize"><a href="#normalize" class="header-anchor">#</a> Normalize</h3> <p>To properly work with our numerical columns, we need to show a relationship between them all that our model can understand. This is commonly done through Normalization, where we scale the data between -1 and 1, and compute a <code>z-score</code></p> <div class="language-python extra-class"><pre class="language-python"><code>norm <span class="token operator">=</span> Normalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Let's make another <code>to</code></p> <div class="language-python extra-class"><pre class="language-python"><code>to <span class="token operator">=</span> TabularPandas<span class="token punctuation">(</span>df<span class="token punctuation">,</span> norm<span class="token punctuation">,</span> cont_names<span class="token operator">=</span>cont_names<span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>norms <span class="token operator">=</span> to<span class="token punctuation">.</span>procs<span class="token punctuation">.</span>normalize
</code></pre></div><p>And take a closer look.</p> <p>We can grab the means and standard deviations like so:</p> <div class="language-python extra-class"><pre class="language-python"><code>norms<span class="token punctuation">.</span>means
</code></pre></div><div class="language- extra-class"><pre><code>{'age': 38.58164675532078,
 'fnlwgt': 189778.36651208502,
 'education-num': 10.079815426825466}
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>norms<span class="token punctuation">.</span>stds
</code></pre></div><div class="language- extra-class"><pre><code>{'age': 13.64022319230403,
 'fnlwgt': 105548.3568809906,
 'education-num': 2.5729591440613078}
</code></pre></div><p>And we can also call <code>to.conts</code> to take a look at our transformed data:</p> <div class="language-python extra-class"><pre class="language-python"><code>to<span class="token punctuation">.</span>conts<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>age</th> <th>fnlwgt</th> <th>education-num</th></tr></thead> <tbody><tr><th>0</th> <td>0.763796</td> <td>-0.838084</td> <td>0.746294</td></tr> <tr><th>1</th> <td>0.397233</td> <td>0.444987</td> <td>1.523609</td></tr> <tr><th>2</th> <td>-0.042642</td> <td>-0.886734</td> <td>NaN</td></tr> <tr><th>3</th> <td>-0.042642</td> <td>-0.728873</td> <td>1.912267</td></tr> <tr><th>4</th> <td>0.250608</td> <td>-1.018314</td> <td>NaN</td></tr></tbody></table></div> <h3 id="fillmissing"><a href="#fillmissing" class="header-anchor">#</a> FillMissing</h3> <p>Now the last thing we need to do is take care of any missing values in our <strong>continuous</strong> variables (we have a special <code>#na#</code> for categorical data already). We have three strategies we can use:</p> <ul><li><code>median</code></li> <li><code>mode</code></li> <li><code>constant</code></li></ul> <p>By default it uses <code>median</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code>fm <span class="token operator">=</span> FillMissing<span class="token punctuation">(</span>fill_strategy<span class="token operator">=</span>FillStrategy<span class="token punctuation">.</span>median<span class="token punctuation">)</span>
</code></pre></div><p>We'll recreate another <a href="https://docs.fast.ai/tabular.core#TabularPandas" target="_blank" rel="noopener noreferrer"><code>TabularPandas</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-python extra-class"><pre class="language-python"><code>to <span class="token operator">=</span> TabularPandas<span class="token punctuation">(</span>df<span class="token punctuation">,</span> fm<span class="token punctuation">,</span> cont_names<span class="token operator">=</span>cont_names<span class="token punctuation">)</span>
</code></pre></div><p>Let's look at those missing values in the first few rows:</p> <div class="language-python extra-class"><pre class="language-python"><code>to<span class="token punctuation">.</span>conts<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>age</th> <th>fnlwgt</th> <th>education-num</th></tr></thead> <tbody><tr><th>0</th> <td>49</td> <td>101320</td> <td>12.0</td></tr> <tr><th>1</th> <td>44</td> <td>236746</td> <td>14.0</td></tr> <tr><th>2</th> <td>38</td> <td>96185</td> <td>10.0</td></tr> <tr><th>3</th> <td>38</td> <td>112847</td> <td>15.0</td></tr> <tr><th>4</th> <td>42</td> <td>82297</td> <td>10.0</td></tr></tbody></table></div> <p><strong>But wait!</strong> There's more!</p> <div class="language-python extra-class"><pre class="language-python"><code>to<span class="token punctuation">.</span>cat_names
</code></pre></div><div class="language- extra-class"><pre><code>(#1) ['education-num_na']
</code></pre></div><p>We have categorical values?! Yes!</p> <div class="language-python extra-class"><pre class="language-python"><code>to<span class="token punctuation">.</span>cats<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>education-num_na</th></tr></thead> <tbody><tr><th>0</th> <td>False</td></tr> <tr><th>1</th> <td>False</td></tr> <tr><th>2</th> <td>True</td></tr> <tr><th>3</th> <td>False</td></tr> <tr><th>4</th> <td>True</td></tr></tbody></table></div> <p>We now have an additional boolean value based on if the value was missing or not too!</p> <h2 id="the-dataloaders"><a href="#the-dataloaders" class="header-anchor">#</a> The DataLoaders</h2> <p>Now let's build our <a href="https://docs.fast.ai/tabular.core#TabularPandas" target="_blank" rel="noopener noreferrer"><code>TabularPandas</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for classifying. We're also going to want to split our data and declare our <code>y_names</code> too:</p> <div class="language-python extra-class"><pre class="language-python"><code>splits <span class="token operator">=</span> RandomSplitter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>range_of<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">)</span>
splits
</code></pre></div><div class="language- extra-class"><pre><code>((#26049) [18724,19703,4062,9102,28824,4054,5833,16188,2731,28161...],
 (#6512) [24465,976,1726,10178,4740,3920,32288,26018,20274,9660...])
</code></pre></div><p>What is <a href="https://fastcore.fast.ai/utils#range_of" target="_blank" rel="noopener noreferrer"><code>range_of</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>?</p> <div class="language-python extra-class"><pre class="language-python"><code>range_of<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>([0, 1, 2, 3, 4], 32561)
</code></pre></div><p>It's a list of total index's in our <code>DataFrame</code></p> <p>We'll use all our <code>cat</code> and <code>cont</code> names, the <code>procs</code>, declare a <code>y_name</code>, and finally specify a single-label classification problem with <a href="https://docs.fast.ai/data.block#CategoryBlock" target="_blank" rel="noopener noreferrer"><code>CategoryBlock</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-python extra-class"><pre class="language-python"><code>cat_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'workclass'</span><span class="token punctuation">,</span> <span class="token string">'education'</span><span class="token punctuation">,</span> <span class="token string">'marital-status'</span><span class="token punctuation">,</span> <span class="token string">'occupation'</span><span class="token punctuation">,</span> <span class="token string">'relationship'</span><span class="token punctuation">,</span> <span class="token string">'race'</span><span class="token punctuation">]</span>
cont_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'fnlwgt'</span><span class="token punctuation">,</span> <span class="token string">'education-num'</span><span class="token punctuation">]</span>
procs <span class="token operator">=</span> <span class="token punctuation">[</span>Categorify<span class="token punctuation">,</span> FillMissing<span class="token punctuation">,</span> Normalize<span class="token punctuation">]</span>
y_names <span class="token operator">=</span> <span class="token string">'salary'</span>
y_block <span class="token operator">=</span> CategoryBlock<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Now that we have everything declared, let's build our <a href="https://docs.fast.ai/tabular.core#TabularPandas" target="_blank" rel="noopener noreferrer"><code>TabularPandas</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-python extra-class"><pre class="language-python"><code>to <span class="token operator">=</span> TabularPandas<span class="token punctuation">(</span>df<span class="token punctuation">,</span> procs<span class="token operator">=</span>procs<span class="token punctuation">,</span> cat_names<span class="token operator">=</span>cat_names<span class="token punctuation">,</span> cont_names<span class="token operator">=</span>cont_names<span class="token punctuation">,</span>
                   y_names<span class="token operator">=</span>y_names<span class="token punctuation">,</span> y_block<span class="token operator">=</span>y_block<span class="token punctuation">,</span> splits<span class="token operator">=</span>splits<span class="token punctuation">)</span>
</code></pre></div><p>And now we can build the <a href="https://docs.fast.ai/data.core#DataLoaders" target="_blank" rel="noopener noreferrer"><code>DataLoaders</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. We can do this one of two ways, first just calling <code>to.dataloaders()</code> on our data:</p> <div class="language-python extra-class"><pre class="language-python"><code>dls <span class="token operator">=</span> to<span class="token punctuation">.</span>dataloaders<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Or we can create the <a href="https://docs.fast.ai/data.core#DataLoaders" target="_blank" rel="noopener noreferrer"><code>DataLoaders</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ourselves (a train and valid). One great reason to do this this way is we can pass in different batch sizes into each <a href="https://docs.fast.ai/tabular.core#TabDataLoader" target="_blank" rel="noopener noreferrer"><code>TabDataLoader</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, along with changing options like <code>shuffle</code> and <code>drop_last</code></p> <p>So how do we use it? Our train and validation data live in to.train and to.valid right now, so we specify that along with our options. When you make a training DataLoader, you want <code>shuffle</code> to be <code>True</code> and <code>drop_last</code> to be <code>True</code> (so we drop the last incomplete batch)</p> <div class="language-python extra-class"><pre class="language-python"><code>trn_dl <span class="token operator">=</span> TabDataLoader<span class="token punctuation">(</span>to<span class="token punctuation">.</span>train<span class="token punctuation">,</span> bs<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> drop_last<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
val_dl <span class="token operator">=</span> TabDataLoader<span class="token punctuation">(</span>to<span class="token punctuation">.</span>valid<span class="token punctuation">,</span> bs<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">)</span>
</code></pre></div><p>Now we can make some <a href="https://docs.fast.ai/data.core#DataLoaders" target="_blank" rel="noopener noreferrer"><code>DataLoaders</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-python extra-class"><pre class="language-python"><code>dls <span class="token operator">=</span> DataLoaders<span class="token punctuation">(</span>trn_dl<span class="token punctuation">,</span> val_dl<span class="token punctuation">)</span>
</code></pre></div><p>And show a batch of data:</p> <div class="language-python extra-class"><pre class="language-python"><code>dls<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>workclass</th> <th>education</th> <th>marital-status</th> <th>occupation</th> <th>relationship</th> <th>race</th> <th>education-num_na</th> <th>age</th> <th>fnlwgt</th> <th>education-num</th> <th>salary</th></tr></thead> <tbody><tr><th>0</th> <td>Private</td> <td>11th</td> <td>Never-married</td> <td>Sales</td> <td>Own-child</td> <td>White</td> <td>False</td> <td>17.0</td> <td>200199.000263</td> <td>7.0</td> <td>&lt;50k</td></tr> <tr><th>1</th> <td>Private</td> <td>HS-grad</td> <td>Divorced</td> <td>Exec-managerial</td> <td>Not-in-family</td> <td>White</td> <td>False</td> <td>36.0</td> <td>256635.997971</td> <td>9.0</td> <td>&lt;50k</td></tr> <tr><th>2</th> <td>Private</td> <td>HS-grad</td> <td>Married-civ-spouse</td> <td>Transport-moving</td> <td>Husband</td> <td>White</td> <td>False</td> <td>44.0</td> <td>172032.000108</td> <td>9.0</td> <td>&lt;50k</td></tr> <tr><th>3</th> <td>Self-emp-not-inc</td> <td>5th-6th</td> <td>Married-civ-spouse</td> <td>Craft-repair</td> <td>Husband</td> <td>White</td> <td>False</td> <td>44.0</td> <td>112506.998184</td> <td>3.0</td> <td>&lt;50k</td></tr> <tr><th>4</th> <td>Local-gov</td> <td>Some-college</td> <td>Never-married</td> <td>Exec-managerial</td> <td>Not-in-family</td> <td>White</td> <td>False</td> <td>40.0</td> <td>74949.002528</td> <td>10.0</td> <td>&lt;50k</td></tr> <tr><th>5</th> <td>?</td> <td>10th</td> <td>Never-married</td> <td>?</td> <td>Own-child</td> <td>White</td> <td>False</td> <td>17.0</td> <td>138506.999270</td> <td>6.0</td> <td>&lt;50k</td></tr> <tr><th>6</th> <td>Private</td> <td>Assoc-voc</td> <td>Married-civ-spouse</td> <td>Prof-specialty</td> <td>Wife</td> <td>White</td> <td>False</td> <td>28.0</td> <td>247819.002902</td> <td>11.0</td> <td>&lt;50k</td></tr> <tr><th>7</th> <td>Private</td> <td>Masters</td> <td>Married-civ-spouse</td> <td>Exec-managerial</td> <td>Husband</td> <td>White</td> <td>False</td> <td>37.0</td> <td>112496.998941</td> <td>14.0</td> <td>&gt;=50k</td></tr> <tr><th>8</th> <td>Private</td> <td>HS-grad</td> <td>Separated</td> <td>Handlers-cleaners</td> <td>Not-in-family</td> <td>Black</td> <td>False</td> <td>41.0</td> <td>215479.000444</td> <td>9.0</td> <td>&lt;50k</td></tr> <tr><th>9</th> <td>Private</td> <td>Assoc-voc</td> <td>Divorced</td> <td>Sales</td> <td>Own-child</td> <td>White</td> <td>False</td> <td>31.0</td> <td>163302.999641</td> <td>11.0</td> <td>&lt;50k</td></tr></tbody></table> <blockquote><p>Why can we do the <code>.dataloaders()</code>? Because <a href="https://docs.fast.ai/tabular.core#TabularPandas" target="_blank" rel="noopener noreferrer"><code>TabularPandas</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> itself is actually a set of <code>TabDataLoaders</code>! See below for a comparison test:</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code>to<span class="token punctuation">.</span>_dbunch_type <span class="token operator">==</span> dls<span class="token punctuation">.</span>_dbunch_type
</code></pre></div><div class="language- extra-class"><pre><code>True
</code></pre></div><h2 id="tabular-learner-and-training-a-model"><a href="#tabular-learner-and-training-a-model" class="header-anchor">#</a> Tabular Learner and Training a Model</h2> <p>Now we can build our <a href="https://docs.fast.ai/learner#Learner" target="_blank" rel="noopener noreferrer"><code>Learner</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>! But what's special about a tabular neural network?</p> <h3 id="categorical-variables"><a href="#categorical-variables" class="header-anchor">#</a> Categorical Variables</h3> <p>When dealing with our categorical data, we create what is called an <strong>embedding matrix</strong>. This allows for a higher dimentionality for relationships between the different categorical cardinalities. Finding the best size ratio was done through experiments by Jeremy on the Rossmann dataset</p> <p>This &quot;rule of thumb&quot; is to use either a maximum embedding space of 600, or 1.6 times the cardinality raised to the 0.56, or written out as:</p> <p>{% raw %}
$$min(600, (1.6 * {var.nunique)}^{0.56})$$
{% endraw %}</p> <p>Let's calculate these embedding sizes for our model to take a look-see:</p> <div class="language-python extra-class"><pre class="language-python"><code>emb_szs <span class="token operator">=</span> get_emb_sz<span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span> emb_szs
</code></pre></div><div class="language- extra-class"><pre><code>[(10, 6), (17, 8), (8, 5), (16, 8), (7, 5), (6, 4), (3, 3)]
</code></pre></div><p>If we want to see what each one aligns to, let's look at the order of <code>cat_names</code></p> <div class="language-python extra-class"><pre class="language-python"><code>to<span class="token punctuation">.</span>cat_names
</code></pre></div><div class="language- extra-class"><pre><code>(#7) ['workclass','education','marital-status','occupation','relationship','race','education-num_na']
</code></pre></div><p>Let's specifically look at <code>workclass</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code>to<span class="token punctuation">[</span><span class="token string">'workclass'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>9
</code></pre></div><p>If you notice, we had <code>10</code> there, this is to take one more column for any missing categorical values that may show</p> <h3 id="numerical-variables"><a href="#numerical-variables" class="header-anchor">#</a> Numerical Variables</h3> <p>Numericals we can simply pass in how many there are to the model:</p> <div class="language-python extra-class"><pre class="language-python"><code>cont_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>cont_names<span class="token punctuation">)</span><span class="token punctuation">;</span> cont_len
</code></pre></div><div class="language- extra-class"><pre><code>3
</code></pre></div><p>And now we have all the pieces we need to build a <a href="https://docs.fast.ai/tabular.model#TabularModel" target="_blank" rel="noopener noreferrer"><code>TabularModel</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>!</p> <h3 id="tabularmodel"><a href="#tabularmodel" class="header-anchor">#</a> TabularModel</h3> <p>What makes this model a little different is our batches is actually two inputs:</p> <div class="language-python extra-class"><pre class="language-python"><code>batch <span class="token operator">=</span> dls<span class="token punctuation">.</span>one_batch<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>batch<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>3
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>
batch<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> batch<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre></div><div class="language- extra-class"><pre><code>(tensor([ 5, 12,  5,  5,  2,  5,  1]), tensor([-0.1858, -0.4134, -0.4253]))
</code></pre></div><p>With the first being our categorical variables and the second being our numericals.</p> <p>Now let's make our model. We'll want our size of our embeddings, the number of continuous variables, the number of outputs, and how large and how many fully connected layers we want to use:</p> <div class="language-python extra-class"><pre class="language-python"><code>net <span class="token operator">=</span> TabularModel<span class="token punctuation">(</span>emb_szs<span class="token punctuation">,</span> cont_len<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>Let's see it's architecture:</p> <div class="language-python extra-class"><pre class="language-python"><code>net
</code></pre></div><div class="language- extra-class"><pre><code>TabularModel(
  (embeds): ModuleList(
    (0): Embedding(10, 6)
    (1): Embedding(17, 8)
    (2): Embedding(8, 5)
    (3): Embedding(16, 8)
    (4): Embedding(7, 5)
    (5): Embedding(6, 4)
    (6): Embedding(3, 3)
  )
  (emb_drop): Dropout(p=0.0, inplace=False)
  (bn_cont): BatchNorm1d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layers): Sequential(
    (0): LinBnDrop(
      (0): BatchNorm1d(42, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): Linear(in_features=42, out_features=200, bias=False)
      (2): ReLU(inplace=True)
    )
    (1): LinBnDrop(
      (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): Linear(in_features=200, out_features=100, bias=False)
      (2): ReLU(inplace=True)
    )
    (2): LinBnDrop(
      (0): Linear(in_features=100, out_features=2, bias=True)
    )
  )
)
</code></pre></div><h3 id="tabular-learner"><a href="#tabular-learner" class="header-anchor">#</a> tabular_learner</h3> <p>Now that we know the background, let's build our model a little bit faster and generate a <a href="https://docs.fast.ai/learner#Learner" target="_blank" rel="noopener noreferrer"><code>Learner</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> too:</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> tabular_learner<span class="token punctuation">(</span>dls<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span>accuracy<span class="token punctuation">)</span>
</code></pre></div><p>And now we can fit!</p> <div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>lr_find<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>SuggestedLRs(lr_min=0.0013182567432522773, lr_steep=1.3182567358016968)
</code></pre></div><p><img src="output_89_2.png" alt="png"></p> <div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><table border="1" class="dataframe"><thead><tr style="text-align:left;"><th>epoch</th> <th>train_loss</th> <th>valid_loss</th> <th>accuracy</th> <th>time</th></tr></thead> <tbody><tr><td>0</td> <td>0.373488</td> <td>0.362226</td> <td>0.841523</td> <td>00:03</td></tr> <tr><td>1</td> <td>0.367182</td> <td>0.354484</td> <td>0.838759</td> <td>00:03</td></tr> <tr><td>2</td> <td>0.368737</td> <td>0.355205</td> <td>0.834306</td> <td>00:03</td></tr></tbody></table> <p>Can we speed this up a little? Yes we can! The more you can load into a batch, the faster you can process the data. This is a careful balance, for tabular data I go to a maximum of 4096 rows per batch if the dataset is large enough for a decent number of batches:</p> <div class="language-python extra-class"><pre class="language-python"><code>dls <span class="token operator">=</span> to<span class="token punctuation">.</span>dataloaders<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">)</span>
learn <span class="token operator">=</span> tabular_learner<span class="token punctuation">(</span>dls<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span>accuracy<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><table border="1" class="dataframe"><thead><tr style="text-align:left;"><th>epoch</th> <th>train_loss</th> <th>valid_loss</th> <th>accuracy</th> <th>time</th></tr></thead> <tbody><tr><td>0</td> <td>0.389950</td> <td>0.407716</td> <td>0.812500</td> <td>00:00</td></tr> <tr><td>1</td> <td>0.366711</td> <td>0.350281</td> <td>0.839681</td> <td>00:00</td></tr> <tr><td>2</td> <td>0.357688</td> <td>0.355638</td> <td>0.836763</td> <td>00:00</td></tr></tbody></table> <p>We can see we fit very quickly, but it didn't fit quite as well (there is a trade-off):</p> <div class="language-python extra-class"><pre class="language-python"><code>dls <span class="token operator">=</span> to<span class="token punctuation">.</span>dataloaders<span class="token punctuation">(</span>bs<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">)</span>
learn <span class="token operator">=</span> tabular_learner<span class="token punctuation">(</span>dls<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span>accuracy<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><table border="1" class="dataframe"><thead><tr style="text-align:left;"><th>epoch</th> <th>train_loss</th> <th>valid_loss</th> <th>accuracy</th> <th>time</th></tr></thead> <tbody><tr><td>0</td> <td>0.449081</td> <td>0.503046</td> <td>0.772267</td> <td>00:00</td></tr> <tr><td>1</td> <td>0.407749</td> <td>0.465814</td> <td>0.758446</td> <td>00:00</td></tr> <tr><td>2</td> <td>0.387042</td> <td>0.445514</td> <td>0.776720</td> <td>00:00</td></tr></tbody></table> <h2 id="inference"><a href="#inference" class="header-anchor">#</a> Inference</h2> <p>Now let's look at how we can perform inference. To do predictions we can use <code>fastai</code>'s in-house <code>learn.predict</code> for individual rows, and <code>get_preds</code> + <code>test_dl</code> for batches of predictions:</p> <div class="language-python extra-class"><pre class="language-python"><code>row<span class="token punctuation">,</span> cls<span class="token punctuation">,</span> probs <span class="token operator">=</span> learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>row<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>workclass</th> <th>education</th> <th>marital-status</th> <th>occupation</th> <th>relationship</th> <th>race</th> <th>education-num_na</th> <th>age</th> <th>fnlwgt</th> <th>education-num</th> <th>salary</th></tr></thead> <tbody><tr><th>0</th> <td>Private</td> <td>Assoc-acdm</td> <td>Married-civ-spouse</td> <td>#na#</td> <td>Wife</td> <td>White</td> <td>False</td> <td>49.0</td> <td>101320.00007</td> <td>12.0</td> <td>&lt;50k</td></tr></tbody></table> <p>Now let's try <code>test_dl</code>. There's something special we can do here too:</p> <div class="language-python extra-class"><pre class="language-python"><code>dl <span class="token operator">=</span> learn<span class="token punctuation">.</span>dls<span class="token punctuation">.</span>test_dl<span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>Let's look at a batch:</p> <div class="language-python extra-class"><pre class="language-python"><code>dl<span class="token punctuation">.</span>show_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>workclass</th> <th>education</th> <th>marital-status</th> <th>occupation</th> <th>relationship</th> <th>race</th> <th>education-num_na</th> <th>age</th> <th>fnlwgt</th> <th>education-num</th> <th>salary</th></tr></thead> <tbody><tr><th>0</th> <td>Private</td> <td>Assoc-acdm</td> <td>Married-civ-spouse</td> <td>#na#</td> <td>Wife</td> <td>White</td> <td>False</td> <td>49.0</td> <td>101320.000070</td> <td>12.0</td> <td>&gt;=50k</td></tr> <tr><th>1</th> <td>Private</td> <td>Masters</td> <td>Divorced</td> <td>Exec-managerial</td> <td>Not-in-family</td> <td>White</td> <td>False</td> <td>44.0</td> <td>236745.999937</td> <td>14.0</td> <td>&gt;=50k</td></tr> <tr><th>2</th> <td>Private</td> <td>HS-grad</td> <td>Divorced</td> <td>#na#</td> <td>Unmarried</td> <td>Black</td> <td>True</td> <td>38.0</td> <td>96185.001851</td> <td>10.0</td> <td>&lt;50k</td></tr> <tr><th>3</th> <td>Self-emp-inc</td> <td>Prof-school</td> <td>Married-civ-spouse</td> <td>Prof-specialty</td> <td>Husband</td> <td>Asian-Pac-Islander</td> <td>False</td> <td>38.0</td> <td>112846.997614</td> <td>15.0</td> <td>&gt;=50k</td></tr> <tr><th>4</th> <td>Self-emp-not-inc</td> <td>7th-8th</td> <td>Married-civ-spouse</td> <td>Other-service</td> <td>Wife</td> <td>Black</td> <td>True</td> <td>42.0</td> <td>82296.994924</td> <td>10.0</td> <td>&lt;50k</td></tr> <tr><th>5</th> <td>Private</td> <td>HS-grad</td> <td>Never-married</td> <td>Handlers-cleaners</td> <td>Own-child</td> <td>White</td> <td>False</td> <td>20.0</td> <td>63210.003417</td> <td>9.0</td> <td>&lt;50k</td></tr> <tr><th>6</th> <td>Private</td> <td>Some-college</td> <td>Divorced</td> <td>#na#</td> <td>Other-relative</td> <td>White</td> <td>False</td> <td>49.0</td> <td>44434.000334</td> <td>10.0</td> <td>&lt;50k</td></tr> <tr><th>7</th> <td>Private</td> <td>11th</td> <td>Married-civ-spouse</td> <td>#na#</td> <td>Husband</td> <td>White</td> <td>False</td> <td>37.0</td> <td>138939.999209</td> <td>7.0</td> <td>&lt;50k</td></tr> <tr><th>8</th> <td>Private</td> <td>HS-grad</td> <td>Married-civ-spouse</td> <td>Craft-repair</td> <td>Husband</td> <td>White</td> <td>False</td> <td>46.0</td> <td>328215.996478</td> <td>9.0</td> <td>&gt;=50k</td></tr> <tr><th>9</th> <td>Self-emp-inc</td> <td>HS-grad</td> <td>Married-civ-spouse</td> <td>#na#</td> <td>Husband</td> <td>White</td> <td>True</td> <td>36.0</td> <td>216711.000298</td> <td>10.0</td> <td>&gt;=50k</td></tr></tbody></table> <p>We have our labels! It'll grab them if possible by default!</p> <p>What does that mean? Well, besides simply calling <code>get_preds</code>, we can also run <code>validate</code> to see how a model performs. This is nice as it can allow for efficient methods when calculating something like permutation importance:</p> <div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>validate<span class="token punctuation">(</span>dl<span class="token operator">=</span>dl<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>(#2) [0.4870152175426483,0.7699999809265137]
</code></pre></div><p>We'll also show an example of <code>get_preds</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code>preds <span class="token operator">=</span> learn<span class="token punctuation">.</span>get_preds<span class="token punctuation">(</span>dl<span class="token operator">=</span>dl<span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>preds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre></div><div class="language- extra-class"><pre><code>tensor([0.5952, 0.4048])
</code></pre></div><p>What would happen if I accidently passed in an unlablled dataset to <code>learn.validate</code> though? Let's find out:</p> <div class="language-python extra-class"><pre class="language-python"><code>df2 <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'salary'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
df2<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>age</th> <th>workclass</th> <th>fnlwgt</th> <th>education</th> <th>education-num</th> <th>marital-status</th> <th>occupation</th> <th>relationship</th> <th>race</th> <th>sex</th> <th>capital-gain</th> <th>capital-loss</th> <th>hours-per-week</th> <th>native-country</th></tr></thead> <tbody><tr><th>0</th> <td>49</td> <td>Private</td> <td>101320</td> <td>Assoc-acdm</td> <td>12.0</td> <td>Married-civ-spouse</td> <td>NaN</td> <td>Wife</td> <td>White</td> <td>Female</td> <td>0</td> <td>1902</td> <td>40</td> <td>United-States</td></tr> <tr><th>1</th> <td>44</td> <td>Private</td> <td>236746</td> <td>Masters</td> <td>14.0</td> <td>Divorced</td> <td>Exec-managerial</td> <td>Not-in-family</td> <td>White</td> <td>Male</td> <td>10520</td> <td>0</td> <td>45</td> <td>United-States</td></tr> <tr><th>2</th> <td>38</td> <td>Private</td> <td>96185</td> <td>HS-grad</td> <td>NaN</td> <td>Divorced</td> <td>NaN</td> <td>Unmarried</td> <td>Black</td> <td>Female</td> <td>0</td> <td>0</td> <td>32</td> <td>United-States</td></tr> <tr><th>3</th> <td>38</td> <td>Self-emp-inc</td> <td>112847</td> <td>Prof-school</td> <td>15.0</td> <td>Married-civ-spouse</td> <td>Prof-specialty</td> <td>Husband</td> <td>Asian-Pac-Islander</td> <td>Male</td> <td>0</td> <td>0</td> <td>40</td> <td>United-States</td></tr> <tr><th>4</th> <td>42</td> <td>Self-emp-not-inc</td> <td>82297</td> <td>7th-8th</td> <td>NaN</td> <td>Married-civ-spouse</td> <td>Other-service</td> <td>Wife</td> <td>Black</td> <td>Female</td> <td>0</td> <td>0</td> <td>50</td> <td>United-States</td></tr></tbody></table></div> <div class="language-python extra-class"><pre class="language-python"><code>dl <span class="token operator">=</span> learn<span class="token punctuation">.</span>dls<span class="token punctuation">.</span>test_dl<span class="token punctuation">(</span>df2<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>validate<span class="token punctuation">(</span>dl<span class="token operator">=</span>dl<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>(#2) [None,None]
</code></pre></div><p>We can see it will simply just return <code>None</code>!</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/walkwithfastai.github.io/assets/js/app.d213da4d.js" defer></script><script src="/walkwithfastai.github.io/assets/js/2.3552a41d.js" defer></script><script src="/walkwithfastai.github.io/assets/js/10.1c53449a.js" defer></script>
  </body>
</html>
